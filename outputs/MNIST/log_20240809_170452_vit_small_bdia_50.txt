2024-08-09 17:04:52,154 - __main__ - INFO - Logging is set up.
2024-08-09 17:04:52,154 - __main__ - INFO - vit_small_bdia_optim_setadam_epoch_50_lr_0.0001_eps_1.0E-08
2024-08-09 17:04:52,154 - __main__ - INFO - ==> Preparing data..
2024-08-09 17:04:52,185 - __main__ - INFO - ==> Building model..
2024-08-09 17:04:52,201 - __main__ - INFO - Model name: vit_small_bdia
2024-08-09 17:04:52,201 - __main__ - INFO - Total epochs: 50
2024-08-09 17:04:52,201 - __main__ - INFO - Using CUDA and data parallel
2024-08-09 17:05:39,851 - __main__ - INFO - epoch: 0 train_loss: 0.5801021313 train_acc: 80.3400 val_loss:  0.2437553315 val_acc: 92.0900 memory_usage: 926.02 MiB
2024-08-09 17:06:26,806 - __main__ - INFO - epoch: 1 train_loss: 0.2496228125 train_acc: 92.0383 val_loss:  0.1508233182 val_acc: 95.3200 memory_usage: 926.02 MiB
2024-08-09 17:07:14,085 - __main__ - INFO - epoch: 2 train_loss: 0.1772248324 train_acc: 94.4317 val_loss:  0.1275405713 val_acc: 96.0600 memory_usage: 926.02 MiB
2024-08-09 17:08:01,250 - __main__ - INFO - epoch: 3 train_loss: 0.1477911427 train_acc: 95.3300 val_loss:  0.1207785305 val_acc: 96.3900 memory_usage: 926.02 MiB
2024-08-09 17:08:48,350 - __main__ - INFO - epoch: 4 train_loss: 0.1287371881 train_acc: 95.9417 val_loss:  0.1092610963 val_acc: 96.7400 memory_usage: 926.02 MiB
2024-08-09 17:09:36,296 - __main__ - INFO - epoch: 5 train_loss: 0.1125377189 train_acc: 96.4933 val_loss:  0.0937824793 val_acc: 97.1300 memory_usage: 926.02 MiB
2024-08-09 17:10:24,776 - __main__ - INFO - epoch: 6 train_loss: 0.1025448014 train_acc: 96.7383 val_loss:  0.0981603159 val_acc: 97.1700 memory_usage: 926.02 MiB
2024-08-09 17:11:13,003 - __main__ - INFO - epoch: 7 train_loss: 0.0935566088 train_acc: 96.9950 val_loss:  0.0958749222 val_acc: 97.1700 memory_usage: 926.02 MiB
2024-08-09 17:12:00,461 - __main__ - INFO - epoch: 8 train_loss: 0.0835498972 train_acc: 97.3467 val_loss:  0.0892527725 val_acc: 97.3700 memory_usage: 926.02 MiB
2024-08-09 17:12:47,516 - __main__ - INFO - epoch: 9 train_loss: 0.0778123437 train_acc: 97.5917 val_loss:  0.0857057700 val_acc: 97.3600 memory_usage: 926.02 MiB
2024-08-09 17:13:34,834 - __main__ - INFO - epoch: 10 train_loss: 0.0704733658 train_acc: 97.7650 val_loss:  0.0877080471 val_acc: 97.4500 memory_usage: 926.02 MiB
2024-08-09 17:14:22,699 - __main__ - INFO - epoch: 11 train_loss: 0.0660029814 train_acc: 97.9067 val_loss:  0.0796644233 val_acc: 97.6000 memory_usage: 926.02 MiB
2024-08-09 17:15:10,971 - __main__ - INFO - epoch: 12 train_loss: 0.0608763660 train_acc: 98.0633 val_loss:  0.0875992219 val_acc: 97.5800 memory_usage: 926.02 MiB
2024-08-09 17:15:59,221 - __main__ - INFO - epoch: 13 train_loss: 0.0586017527 train_acc: 98.1617 val_loss:  0.0737859341 val_acc: 97.8500 memory_usage: 926.02 MiB
2024-08-09 17:16:46,685 - __main__ - INFO - epoch: 14 train_loss: 0.0530035491 train_acc: 98.2733 val_loss:  0.0910419738 val_acc: 97.6000 memory_usage: 926.02 MiB
2024-08-09 17:17:34,889 - __main__ - INFO - epoch: 15 train_loss: 0.0491058332 train_acc: 98.4017 val_loss:  0.0828780967 val_acc: 97.7200 memory_usage: 926.02 MiB
2024-08-09 17:18:22,025 - __main__ - INFO - epoch: 16 train_loss: 0.0457864654 train_acc: 98.5467 val_loss:  0.0943100098 val_acc: 97.5900 memory_usage: 926.02 MiB
2024-08-09 17:19:09,053 - __main__ - INFO - epoch: 17 train_loss: 0.0426606675 train_acc: 98.6517 val_loss:  0.0786559564 val_acc: 97.7900 memory_usage: 926.02 MiB
2024-08-09 17:19:56,730 - __main__ - INFO - epoch: 18 train_loss: 0.0407960075 train_acc: 98.7033 val_loss:  0.0721490757 val_acc: 98.1100 memory_usage: 926.02 MiB
2024-08-09 17:20:44,246 - __main__ - INFO - epoch: 19 train_loss: 0.0379467089 train_acc: 98.8117 val_loss:  0.0771893948 val_acc: 97.8300 memory_usage: 926.02 MiB
2024-08-09 17:21:31,767 - __main__ - INFO - epoch: 20 train_loss: 0.0340289365 train_acc: 98.9017 val_loss:  0.0751618526 val_acc: 98.0600 memory_usage: 926.02 MiB
2024-08-09 17:22:19,079 - __main__ - INFO - epoch: 21 train_loss: 0.0354219317 train_acc: 98.8400 val_loss:  0.0835908731 val_acc: 97.8500 memory_usage: 926.02 MiB
2024-08-09 17:23:06,562 - __main__ - INFO - epoch: 22 train_loss: 0.0326744757 train_acc: 98.9300 val_loss:  0.0799575357 val_acc: 97.9500 memory_usage: 926.02 MiB
2024-08-09 17:23:53,999 - __main__ - INFO - epoch: 23 train_loss: 0.0271840714 train_acc: 99.0900 val_loss:  0.0730559985 val_acc: 98.2200 memory_usage: 926.02 MiB
2024-08-09 17:24:41,139 - __main__ - INFO - epoch: 24 train_loss: 0.0252230258 train_acc: 99.1767 val_loss:  0.0807461431 val_acc: 97.8800 memory_usage: 926.02 MiB
2024-08-09 17:25:28,425 - __main__ - INFO - epoch: 25 train_loss: 0.0243970749 train_acc: 99.1967 val_loss:  0.0691312916 val_acc: 98.1500 memory_usage: 926.02 MiB
2024-08-09 17:26:16,245 - __main__ - INFO - epoch: 26 train_loss: 0.0214381481 train_acc: 99.3150 val_loss:  0.0758252725 val_acc: 98.0500 memory_usage: 926.02 MiB
2024-08-09 17:27:04,131 - __main__ - INFO - epoch: 27 train_loss: 0.0200685244 train_acc: 99.3517 val_loss:  0.0813917197 val_acc: 97.9200 memory_usage: 926.02 MiB
2024-08-09 17:27:52,464 - __main__ - INFO - epoch: 28 train_loss: 0.0196803941 train_acc: 99.3517 val_loss:  0.0763703322 val_acc: 98.2600 memory_usage: 926.02 MiB
2024-08-09 17:28:40,365 - __main__ - INFO - epoch: 29 train_loss: 0.0168011285 train_acc: 99.4233 val_loss:  0.0711760379 val_acc: 98.3200 memory_usage: 926.02 MiB
2024-08-09 17:29:28,481 - __main__ - INFO - epoch: 30 train_loss: 0.0167690430 train_acc: 99.4200 val_loss:  0.0702296091 val_acc: 98.2600 memory_usage: 926.02 MiB
2024-08-09 17:30:15,689 - __main__ - INFO - epoch: 31 train_loss: 0.0137916147 train_acc: 99.5417 val_loss:  0.0730608841 val_acc: 98.2100 memory_usage: 926.02 MiB
2024-08-09 17:31:02,831 - __main__ - INFO - epoch: 32 train_loss: 0.0125362217 train_acc: 99.5967 val_loss:  0.0738878011 val_acc: 98.3600 memory_usage: 926.02 MiB
2024-08-09 17:31:50,538 - __main__ - INFO - epoch: 33 train_loss: 0.0115624467 train_acc: 99.6533 val_loss:  0.0721681175 val_acc: 98.3800 memory_usage: 926.02 MiB
2024-08-09 17:32:38,370 - __main__ - INFO - epoch: 34 train_loss: 0.0103282872 train_acc: 99.6783 val_loss:  0.0715443623 val_acc: 98.3400 memory_usage: 926.02 MiB
2024-08-09 17:33:26,515 - __main__ - INFO - epoch: 35 train_loss: 0.0083259619 train_acc: 99.7250 val_loss:  0.0783945820 val_acc: 98.3000 memory_usage: 926.02 MiB
2024-08-09 17:34:14,399 - __main__ - INFO - epoch: 36 train_loss: 0.0085297944 train_acc: 99.7333 val_loss:  0.0795198373 val_acc: 98.2800 memory_usage: 926.02 MiB
2024-08-09 17:35:02,157 - __main__ - INFO - epoch: 37 train_loss: 0.0077151474 train_acc: 99.7617 val_loss:  0.0789981652 val_acc: 98.3200 memory_usage: 926.02 MiB
2024-08-09 17:35:50,049 - __main__ - INFO - epoch: 38 train_loss: 0.0062816868 train_acc: 99.8217 val_loss:  0.0770263037 val_acc: 98.3500 memory_usage: 926.02 MiB
2024-08-09 17:36:37,116 - __main__ - INFO - epoch: 39 train_loss: 0.0060904575 train_acc: 99.8333 val_loss:  0.0803664987 val_acc: 98.2800 memory_usage: 926.02 MiB
2024-08-09 17:37:24,485 - __main__ - INFO - epoch: 40 train_loss: 0.0050481786 train_acc: 99.8483 val_loss:  0.0801279062 val_acc: 98.3500 memory_usage: 926.02 MiB
2024-08-09 17:38:12,333 - __main__ - INFO - epoch: 41 train_loss: 0.0052787320 train_acc: 99.8567 val_loss:  0.0798849946 val_acc: 98.3900 memory_usage: 926.02 MiB
2024-08-09 17:39:00,377 - __main__ - INFO - epoch: 42 train_loss: 0.0043636146 train_acc: 99.8767 val_loss:  0.0808315267 val_acc: 98.3400 memory_usage: 926.02 MiB
2024-08-09 17:39:47,942 - __main__ - INFO - epoch: 43 train_loss: 0.0042289522 train_acc: 99.8783 val_loss:  0.0819128972 val_acc: 98.2800 memory_usage: 926.02 MiB
2024-08-09 17:40:35,614 - __main__ - INFO - epoch: 44 train_loss: 0.0043755060 train_acc: 99.8767 val_loss:  0.0813699927 val_acc: 98.3500 memory_usage: 926.02 MiB
2024-08-09 17:41:23,048 - __main__ - INFO - epoch: 45 train_loss: 0.0038044706 train_acc: 99.8967 val_loss:  0.0822006191 val_acc: 98.3400 memory_usage: 926.02 MiB
2024-08-09 17:42:10,042 - __main__ - INFO - epoch: 46 train_loss: 0.0038051136 train_acc: 99.8967 val_loss:  0.0825425013 val_acc: 98.3500 memory_usage: 926.02 MiB
2024-08-09 17:42:57,321 - __main__ - INFO - epoch: 47 train_loss: 0.0033768161 train_acc: 99.9133 val_loss:  0.0811442486 val_acc: 98.3700 memory_usage: 926.02 MiB
2024-08-09 17:43:44,496 - __main__ - INFO - epoch: 48 train_loss: 0.0030475489 train_acc: 99.9083 val_loss:  0.0813292989 val_acc: 98.3700 memory_usage: 926.02 MiB
2024-08-09 17:44:32,076 - __main__ - INFO - epoch: 49 train_loss: 0.0029474035 train_acc: 99.9467 val_loss:  0.0807687669 val_acc: 98.4000 memory_usage: 926.02 MiB
2024-08-09 17:44:32,076 - __main__ - INFO - Best accuracy: 98.4000
2024-08-09 17:44:32,076 - __main__ - INFO - Max memory usage: 926.02 MB
2024-08-09 17:44:32,076 - __main__ - INFO - Total memory usage: 46300.81 MiB
