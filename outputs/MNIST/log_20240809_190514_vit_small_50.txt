2024-08-09 19:05:14,669 - __main__ - INFO - Logging is set up.
2024-08-09 19:05:14,669 - __main__ - INFO - vit_small_optim_setadam_epoch_50_lr_0.0001_eps_1.0E-08
2024-08-09 19:05:14,669 - __main__ - INFO - ==> Preparing data..
2024-08-09 19:05:14,685 - __main__ - INFO - ==> Building model..
2024-08-09 19:05:14,700 - __main__ - INFO - Model name: vit_small
2024-08-09 19:05:14,700 - __main__ - INFO - Total epochs: 50
2024-08-09 19:05:14,700 - __main__ - INFO - Using CUDA and data parallel
2024-08-09 19:05:50,645 - __main__ - INFO - epoch: 0 train_loss: 0.4639485282 train_acc: 84.4667 val_loss:  0.1886683382 val_acc: 94.0200 memory_usage: 1320.08 MiB
2024-08-09 19:06:26,460 - __main__ - INFO - epoch: 1 train_loss: 0.1755459539 train_acc: 94.3767 val_loss:  0.1269322740 val_acc: 95.6600 memory_usage: 1320.08 MiB
2024-08-09 19:07:01,275 - __main__ - INFO - epoch: 2 train_loss: 0.1281688079 train_acc: 95.9767 val_loss:  0.1154456735 val_acc: 96.4000 memory_usage: 1320.08 MiB
2024-08-09 19:07:36,252 - __main__ - INFO - epoch: 3 train_loss: 0.1081606111 train_acc: 96.5450 val_loss:  0.0981698776 val_acc: 97.0000 memory_usage: 1320.08 MiB
2024-08-09 19:08:11,068 - __main__ - INFO - epoch: 4 train_loss: 0.0920822287 train_acc: 97.0450 val_loss:  0.1035405804 val_acc: 96.9100 memory_usage: 1320.08 MiB
2024-08-09 19:08:45,700 - __main__ - INFO - epoch: 5 train_loss: 0.0796461900 train_acc: 97.4783 val_loss:  0.0879082616 val_acc: 97.3400 memory_usage: 1320.08 MiB
2024-08-09 19:09:20,788 - __main__ - INFO - epoch: 6 train_loss: 0.0710970474 train_acc: 97.7300 val_loss:  0.0924035822 val_acc: 97.2000 memory_usage: 1320.08 MiB
2024-08-09 19:09:55,868 - __main__ - INFO - epoch: 7 train_loss: 0.0637434220 train_acc: 97.9433 val_loss:  0.0736552713 val_acc: 97.8000 memory_usage: 1320.08 MiB
2024-08-09 19:10:30,359 - __main__ - INFO - epoch: 8 train_loss: 0.0558006031 train_acc: 98.2033 val_loss:  0.0813679461 val_acc: 97.5800 memory_usage: 1320.08 MiB
2024-08-09 19:11:05,324 - __main__ - INFO - epoch: 9 train_loss: 0.0528808915 train_acc: 98.3167 val_loss:  0.0854696173 val_acc: 97.4800 memory_usage: 1320.08 MiB
2024-08-09 19:11:40,310 - __main__ - INFO - epoch: 10 train_loss: 0.0444850631 train_acc: 98.6217 val_loss:  0.0787995947 val_acc: 97.8100 memory_usage: 1320.08 MiB
2024-08-09 19:12:14,799 - __main__ - INFO - epoch: 11 train_loss: 0.0433944980 train_acc: 98.5767 val_loss:  0.0813076560 val_acc: 97.8100 memory_usage: 1320.08 MiB
2024-08-09 19:12:49,569 - __main__ - INFO - epoch: 12 train_loss: 0.0377297810 train_acc: 98.7083 val_loss:  0.0883251297 val_acc: 97.3000 memory_usage: 1320.08 MiB
2024-08-09 19:13:24,217 - __main__ - INFO - epoch: 13 train_loss: 0.0338527555 train_acc: 98.8833 val_loss:  0.0750952545 val_acc: 97.9600 memory_usage: 1320.08 MiB
2024-08-09 19:13:58,924 - __main__ - INFO - epoch: 14 train_loss: 0.0310118363 train_acc: 98.9683 val_loss:  0.0843759291 val_acc: 97.8500 memory_usage: 1320.08 MiB
2024-08-09 19:14:33,458 - __main__ - INFO - epoch: 15 train_loss: 0.0282406739 train_acc: 99.0867 val_loss:  0.0765538660 val_acc: 97.9000 memory_usage: 1320.08 MiB
2024-08-09 19:15:08,253 - __main__ - INFO - epoch: 16 train_loss: 0.0234472435 train_acc: 99.2467 val_loss:  0.0833739688 val_acc: 97.7000 memory_usage: 1320.08 MiB
2024-08-09 19:15:43,373 - __main__ - INFO - epoch: 17 train_loss: 0.0236527247 train_acc: 99.2283 val_loss:  0.0865129236 val_acc: 97.6400 memory_usage: 1320.08 MiB
2024-08-09 19:16:18,076 - __main__ - INFO - epoch: 18 train_loss: 0.0209048447 train_acc: 99.3217 val_loss:  0.0740251574 val_acc: 97.9600 memory_usage: 1320.08 MiB
2024-08-09 19:16:52,805 - __main__ - INFO - epoch: 19 train_loss: 0.0199527440 train_acc: 99.3383 val_loss:  0.0755213688 val_acc: 98.0500 memory_usage: 1320.08 MiB
2024-08-09 19:17:27,727 - __main__ - INFO - epoch: 20 train_loss: 0.0163479012 train_acc: 99.4450 val_loss:  0.0625523144 val_acc: 98.3000 memory_usage: 1320.08 MiB
2024-08-09 19:18:02,167 - __main__ - INFO - epoch: 21 train_loss: 0.0173421596 train_acc: 99.4583 val_loss:  0.0683593584 val_acc: 98.2200 memory_usage: 1320.08 MiB
2024-08-09 19:18:36,749 - __main__ - INFO - epoch: 22 train_loss: 0.0131656153 train_acc: 99.5550 val_loss:  0.0807832187 val_acc: 97.9300 memory_usage: 1320.08 MiB
2024-08-09 19:19:11,314 - __main__ - INFO - epoch: 23 train_loss: 0.0122554786 train_acc: 99.6267 val_loss:  0.0749919401 val_acc: 98.0300 memory_usage: 1320.08 MiB
2024-08-09 19:19:46,018 - __main__ - INFO - epoch: 24 train_loss: 0.0112712921 train_acc: 99.6617 val_loss:  0.0840812494 val_acc: 97.9800 memory_usage: 1320.08 MiB
2024-08-09 19:20:20,597 - __main__ - INFO - epoch: 25 train_loss: 0.0095994165 train_acc: 99.6983 val_loss:  0.0779684088 val_acc: 98.0900 memory_usage: 1320.08 MiB
2024-08-09 19:20:55,623 - __main__ - INFO - epoch: 26 train_loss: 0.0095789854 train_acc: 99.6900 val_loss:  0.0788735843 val_acc: 98.1500 memory_usage: 1320.08 MiB
2024-08-09 19:21:31,004 - __main__ - INFO - epoch: 27 train_loss: 0.0086427887 train_acc: 99.7233 val_loss:  0.0801593075 val_acc: 98.1300 memory_usage: 1320.08 MiB
2024-08-09 19:22:05,995 - __main__ - INFO - epoch: 28 train_loss: 0.0070247166 train_acc: 99.7767 val_loss:  0.0740807008 val_acc: 98.3200 memory_usage: 1320.08 MiB
2024-08-09 19:22:40,722 - __main__ - INFO - epoch: 29 train_loss: 0.0062232462 train_acc: 99.8050 val_loss:  0.0777164833 val_acc: 98.3200 memory_usage: 1320.08 MiB
2024-08-09 19:23:15,890 - __main__ - INFO - epoch: 30 train_loss: 0.0059975415 train_acc: 99.8200 val_loss:  0.0662212103 val_acc: 98.4400 memory_usage: 1320.08 MiB
2024-08-09 19:23:50,840 - __main__ - INFO - epoch: 31 train_loss: 0.0046458826 train_acc: 99.8550 val_loss:  0.0767835283 val_acc: 98.3100 memory_usage: 1320.08 MiB
2024-08-09 19:24:25,625 - __main__ - INFO - epoch: 32 train_loss: 0.0030317596 train_acc: 99.9183 val_loss:  0.0682851020 val_acc: 98.4900 memory_usage: 1320.08 MiB
2024-08-09 19:25:00,313 - __main__ - INFO - epoch: 33 train_loss: 0.0033351749 train_acc: 99.8917 val_loss:  0.0682414409 val_acc: 98.5700 memory_usage: 1320.08 MiB
2024-08-09 19:25:35,176 - __main__ - INFO - epoch: 34 train_loss: 0.0026663496 train_acc: 99.9217 val_loss:  0.0821840260 val_acc: 98.3100 memory_usage: 1320.08 MiB
2024-08-09 19:26:10,145 - __main__ - INFO - epoch: 35 train_loss: 0.0022828069 train_acc: 99.9300 val_loss:  0.0669314557 val_acc: 98.5600 memory_usage: 1320.08 MiB
2024-08-09 19:26:45,046 - __main__ - INFO - epoch: 36 train_loss: 0.0015186228 train_acc: 99.9700 val_loss:  0.0647576604 val_acc: 98.6000 memory_usage: 1320.08 MiB
2024-08-09 19:27:20,121 - __main__ - INFO - epoch: 37 train_loss: 0.0020981687 train_acc: 99.9400 val_loss:  0.0742048668 val_acc: 98.3400 memory_usage: 1320.08 MiB
2024-08-09 19:27:55,379 - __main__ - INFO - epoch: 38 train_loss: 0.0015096135 train_acc: 99.9667 val_loss:  0.0700417220 val_acc: 98.5100 memory_usage: 1320.08 MiB
2024-08-09 19:28:30,111 - __main__ - INFO - epoch: 39 train_loss: 0.0012433874 train_acc: 99.9750 val_loss:  0.0674447526 val_acc: 98.5600 memory_usage: 1320.08 MiB
2024-08-09 19:29:05,086 - __main__ - INFO - epoch: 40 train_loss: 0.0008615533 train_acc: 99.9900 val_loss:  0.0650264012 val_acc: 98.6700 memory_usage: 1320.08 MiB
2024-08-09 19:29:40,094 - __main__ - INFO - epoch: 41 train_loss: 0.0007037773 train_acc: 99.9917 val_loss:  0.0715054910 val_acc: 98.6300 memory_usage: 1320.08 MiB
2024-08-09 19:30:14,666 - __main__ - INFO - epoch: 42 train_loss: 0.0007751649 train_acc: 99.9833 val_loss:  0.0680490455 val_acc: 98.6200 memory_usage: 1320.08 MiB
2024-08-09 19:30:49,281 - __main__ - INFO - epoch: 43 train_loss: 0.0005691818 train_acc: 99.9967 val_loss:  0.0691574218 val_acc: 98.6100 memory_usage: 1320.08 MiB
2024-08-09 19:31:24,166 - __main__ - INFO - epoch: 44 train_loss: 0.0004936074 train_acc: 99.9933 val_loss:  0.0661028928 val_acc: 98.6700 memory_usage: 1320.08 MiB
2024-08-09 19:31:59,176 - __main__ - INFO - epoch: 45 train_loss: 0.0004459323 train_acc: 99.9917 val_loss:  0.0680668912 val_acc: 98.6500 memory_usage: 1320.08 MiB
2024-08-09 19:32:33,982 - __main__ - INFO - epoch: 46 train_loss: 0.0004895852 train_acc: 99.9933 val_loss:  0.0678588671 val_acc: 98.6600 memory_usage: 1320.08 MiB
2024-08-09 19:33:09,062 - __main__ - INFO - epoch: 47 train_loss: 0.0005200166 train_acc: 99.9883 val_loss:  0.0675280789 val_acc: 98.6600 memory_usage: 1320.08 MiB
2024-08-09 19:33:44,355 - __main__ - INFO - epoch: 48 train_loss: 0.0003538315 train_acc: 99.9967 val_loss:  0.0677495290 val_acc: 98.6800 memory_usage: 1320.08 MiB
2024-08-09 19:34:19,196 - __main__ - INFO - epoch: 49 train_loss: 0.0004564275 train_acc: 99.9917 val_loss:  0.0676292333 val_acc: 98.7100 memory_usage: 1320.08 MiB
2024-08-09 19:34:19,196 - __main__ - INFO - Best accuracy: 98.7100
2024-08-09 19:34:19,196 - __main__ - INFO - Max memory usage: 1320.08 MB
2024-08-09 19:34:19,196 - __main__ - INFO - Total memory usage: 66004.17 MiB
