2024-08-09 15:41:28,984 - __main__ - INFO - Logging is set up.
2024-08-09 15:41:28,984 - __main__ - INFO - vit_small_bdia_optim_setadam_epoch_50_lr_0.0001_eps_1.0E-08
2024-08-09 15:41:28,984 - __main__ - INFO - ==> Preparing data..
2024-08-09 15:41:29,011 - __main__ - INFO - ==> Building model..
2024-08-09 15:41:29,184 - __main__ - INFO - Model name: vit_small_bdia
2024-08-09 15:41:29,184 - __main__ - INFO - Total epochs: 50
2024-08-09 15:41:29,184 - __main__ - INFO - Using CUDA and data parallel
2024-08-09 15:42:16,624 - __main__ - INFO - epoch: 0 train_loss: 0.5628415943 train_acc: 81.0117 val_loss:  0.2241258197 val_acc: 92.7700 memory_usage: 865.01 MiB
2024-08-09 15:43:03,712 - __main__ - INFO - epoch: 1 train_loss: 0.2377317053 train_acc: 92.5133 val_loss:  0.1585307140 val_acc: 94.9800 memory_usage: 865.01 MiB
2024-08-09 15:43:50,927 - __main__ - INFO - epoch: 2 train_loss: 0.1799897906 train_acc: 94.3133 val_loss:  0.1314180426 val_acc: 96.0400 memory_usage: 865.01 MiB
2024-08-09 15:44:38,616 - __main__ - INFO - epoch: 3 train_loss: 0.1528084157 train_acc: 95.1767 val_loss:  0.1120195173 val_acc: 96.5000 memory_usage: 865.01 MiB
2024-08-09 15:45:26,131 - __main__ - INFO - epoch: 4 train_loss: 0.1283674221 train_acc: 95.9567 val_loss:  0.1211667016 val_acc: 96.3600 memory_usage: 865.01 MiB
2024-08-09 15:46:14,024 - __main__ - INFO - epoch: 5 train_loss: 0.1128272478 train_acc: 96.4833 val_loss:  0.1029092234 val_acc: 96.9300 memory_usage: 865.01 MiB
2024-08-09 15:47:01,604 - __main__ - INFO - epoch: 6 train_loss: 0.1005126348 train_acc: 96.7817 val_loss:  0.1174643821 val_acc: 96.3000 memory_usage: 865.01 MiB
2024-08-09 15:47:49,025 - __main__ - INFO - epoch: 7 train_loss: 0.0924034198 train_acc: 97.0833 val_loss:  0.0827743640 val_acc: 97.4700 memory_usage: 865.01 MiB
2024-08-09 15:48:35,897 - __main__ - INFO - epoch: 8 train_loss: 0.0875752283 train_acc: 97.2050 val_loss:  0.0818989810 val_acc: 97.4700 memory_usage: 865.01 MiB
2024-08-09 15:49:23,173 - __main__ - INFO - epoch: 9 train_loss: 0.0789577998 train_acc: 97.4350 val_loss:  0.0763324145 val_acc: 97.7700 memory_usage: 865.01 MiB
2024-08-09 15:50:11,029 - __main__ - INFO - epoch: 10 train_loss: 0.0704319445 train_acc: 97.7233 val_loss:  0.0767842823 val_acc: 97.5700 memory_usage: 865.01 MiB
2024-08-09 15:50:59,387 - __main__ - INFO - epoch: 11 train_loss: 0.0689047208 train_acc: 97.8050 val_loss:  0.0730113190 val_acc: 97.7700 memory_usage: 865.01 MiB
2024-08-09 15:51:47,748 - __main__ - INFO - epoch: 12 train_loss: 0.0619087703 train_acc: 98.0583 val_loss:  0.0854740555 val_acc: 97.5600 memory_usage: 865.01 MiB
2024-08-09 15:52:35,743 - __main__ - INFO - epoch: 13 train_loss: 0.0585953872 train_acc: 98.1967 val_loss:  0.0716582654 val_acc: 97.9700 memory_usage: 865.01 MiB
2024-08-09 15:53:23,908 - __main__ - INFO - epoch: 14 train_loss: 0.0528805757 train_acc: 98.2817 val_loss:  0.0768956730 val_acc: 97.9200 memory_usage: 865.01 MiB
2024-08-09 15:54:11,215 - __main__ - INFO - epoch: 15 train_loss: 0.0489960633 train_acc: 98.4317 val_loss:  0.0747647575 val_acc: 97.8500 memory_usage: 865.01 MiB
2024-08-09 15:54:58,666 - __main__ - INFO - epoch: 16 train_loss: 0.0488187444 train_acc: 98.4400 val_loss:  0.0734467579 val_acc: 97.9700 memory_usage: 865.01 MiB
2024-08-09 15:55:46,111 - __main__ - INFO - epoch: 17 train_loss: 0.0448382143 train_acc: 98.5500 val_loss:  0.0825310366 val_acc: 97.6100 memory_usage: 865.01 MiB
2024-08-09 15:56:33,489 - __main__ - INFO - epoch: 18 train_loss: 0.0418288842 train_acc: 98.6417 val_loss:  0.0706473392 val_acc: 98.0700 memory_usage: 865.01 MiB
2024-08-09 15:57:21,204 - __main__ - INFO - epoch: 19 train_loss: 0.0392229478 train_acc: 98.7283 val_loss:  0.0766736522 val_acc: 98.0300 memory_usage: 865.01 MiB
2024-08-09 15:58:08,672 - __main__ - INFO - epoch: 20 train_loss: 0.0370928181 train_acc: 98.7683 val_loss:  0.0733702079 val_acc: 98.0900 memory_usage: 865.01 MiB
2024-08-09 15:58:56,209 - __main__ - INFO - epoch: 21 train_loss: 0.0318770534 train_acc: 98.9733 val_loss:  0.0754313386 val_acc: 98.1200 memory_usage: 865.01 MiB
2024-08-09 15:59:43,981 - __main__ - INFO - epoch: 22 train_loss: 0.0330091045 train_acc: 98.9750 val_loss:  0.0700471973 val_acc: 98.2600 memory_usage: 865.01 MiB
2024-08-09 16:00:31,078 - __main__ - INFO - epoch: 23 train_loss: 0.0300959339 train_acc: 99.0317 val_loss:  0.0636552283 val_acc: 98.3700 memory_usage: 865.01 MiB
2024-08-09 16:01:18,538 - __main__ - INFO - epoch: 24 train_loss: 0.0259563147 train_acc: 99.1350 val_loss:  0.0693766539 val_acc: 98.2700 memory_usage: 865.01 MiB
2024-08-09 16:02:06,257 - __main__ - INFO - epoch: 25 train_loss: 0.0248103138 train_acc: 99.2250 val_loss:  0.0709269209 val_acc: 98.2200 memory_usage: 865.01 MiB
2024-08-09 16:02:54,057 - __main__ - INFO - epoch: 26 train_loss: 0.0227179848 train_acc: 99.2000 val_loss:  0.0718801856 val_acc: 98.1700 memory_usage: 865.01 MiB
2024-08-09 16:03:42,351 - __main__ - INFO - epoch: 27 train_loss: 0.0209929683 train_acc: 99.3333 val_loss:  0.0714852547 val_acc: 98.2500 memory_usage: 865.01 MiB
2024-08-09 16:04:30,631 - __main__ - INFO - epoch: 28 train_loss: 0.0196702170 train_acc: 99.3567 val_loss:  0.0714863133 val_acc: 98.2000 memory_usage: 865.01 MiB
2024-08-09 16:05:18,760 - __main__ - INFO - epoch: 29 train_loss: 0.0173844103 train_acc: 99.4483 val_loss:  0.0761449821 val_acc: 98.2300 memory_usage: 865.01 MiB
2024-08-09 16:06:06,215 - __main__ - INFO - epoch: 30 train_loss: 0.0157366904 train_acc: 99.5017 val_loss:  0.0708474977 val_acc: 98.2300 memory_usage: 865.01 MiB
2024-08-09 16:06:53,509 - __main__ - INFO - epoch: 31 train_loss: 0.0138309376 train_acc: 99.5600 val_loss:  0.0684799495 val_acc: 98.3100 memory_usage: 865.01 MiB
2024-08-09 16:07:40,967 - __main__ - INFO - epoch: 32 train_loss: 0.0138970070 train_acc: 99.5350 val_loss:  0.0720553718 val_acc: 98.3300 memory_usage: 865.01 MiB
2024-08-09 16:08:28,880 - __main__ - INFO - epoch: 33 train_loss: 0.0105182581 train_acc: 99.6533 val_loss:  0.0779775876 val_acc: 98.3000 memory_usage: 865.01 MiB
2024-08-09 16:09:16,516 - __main__ - INFO - epoch: 34 train_loss: 0.0096414029 train_acc: 99.6983 val_loss:  0.0755683146 val_acc: 98.3900 memory_usage: 865.01 MiB
2024-08-09 16:10:04,062 - __main__ - INFO - epoch: 35 train_loss: 0.0093805298 train_acc: 99.6867 val_loss:  0.0711620803 val_acc: 98.4000 memory_usage: 865.01 MiB
2024-08-09 16:10:52,109 - __main__ - INFO - epoch: 36 train_loss: 0.0081623913 train_acc: 99.7517 val_loss:  0.0788947743 val_acc: 98.2700 memory_usage: 865.01 MiB
2024-08-09 16:11:39,392 - __main__ - INFO - epoch: 37 train_loss: 0.0077832260 train_acc: 99.7517 val_loss:  0.0745927924 val_acc: 98.4200 memory_usage: 865.01 MiB
2024-08-09 16:12:26,328 - __main__ - INFO - epoch: 38 train_loss: 0.0064604061 train_acc: 99.7950 val_loss:  0.0784035269 val_acc: 98.3400 memory_usage: 865.01 MiB
2024-08-09 16:13:13,532 - __main__ - INFO - epoch: 39 train_loss: 0.0066936250 train_acc: 99.8050 val_loss:  0.0715010184 val_acc: 98.4500 memory_usage: 865.01 MiB
2024-08-09 16:14:00,981 - __main__ - INFO - epoch: 40 train_loss: 0.0053545973 train_acc: 99.8567 val_loss:  0.0731762759 val_acc: 98.4300 memory_usage: 865.01 MiB
2024-08-09 16:14:48,530 - __main__ - INFO - epoch: 41 train_loss: 0.0049873292 train_acc: 99.8650 val_loss:  0.0732937758 val_acc: 98.4200 memory_usage: 865.01 MiB
2024-08-09 16:15:36,387 - __main__ - INFO - epoch: 42 train_loss: 0.0046787485 train_acc: 99.8633 val_loss:  0.0747299095 val_acc: 98.3700 memory_usage: 865.01 MiB
2024-08-09 16:16:23,912 - __main__ - INFO - epoch: 43 train_loss: 0.0041921975 train_acc: 99.8783 val_loss:  0.0726372476 val_acc: 98.4600 memory_usage: 865.01 MiB
2024-08-09 16:17:11,572 - __main__ - INFO - epoch: 44 train_loss: 0.0035505695 train_acc: 99.9083 val_loss:  0.0777999998 val_acc: 98.3300 memory_usage: 865.01 MiB
2024-08-09 16:17:58,753 - __main__ - INFO - epoch: 45 train_loss: 0.0037261321 train_acc: 99.8883 val_loss:  0.0759770396 val_acc: 98.3300 memory_usage: 865.01 MiB
2024-08-09 16:18:45,903 - __main__ - INFO - epoch: 46 train_loss: 0.0036519680 train_acc: 99.8983 val_loss:  0.0738379786 val_acc: 98.4800 memory_usage: 865.01 MiB
2024-08-09 16:19:33,044 - __main__ - INFO - epoch: 47 train_loss: 0.0033088288 train_acc: 99.9167 val_loss:  0.0744909620 val_acc: 98.3900 memory_usage: 865.01 MiB
2024-08-09 16:20:20,125 - __main__ - INFO - epoch: 48 train_loss: 0.0031495754 train_acc: 99.9217 val_loss:  0.0745292418 val_acc: 98.4400 memory_usage: 865.01 MiB
2024-08-09 16:21:07,788 - __main__ - INFO - epoch: 49 train_loss: 0.0033564612 train_acc: 99.9133 val_loss:  0.0752266766 val_acc: 98.4000 memory_usage: 865.01 MiB
2024-08-09 16:21:07,788 - __main__ - INFO - Best accuracy: 98.4800
2024-08-09 16:21:07,788 - __main__ - INFO - Max memory usage: 865.01 MB
2024-08-09 16:21:07,788 - __main__ - INFO - Total memory usage: 43250.49 MiB
