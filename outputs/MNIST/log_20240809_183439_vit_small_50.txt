2024-08-09 18:34:39,130 - __main__ - INFO - Logging is set up.
2024-08-09 18:34:39,130 - __main__ - INFO - vit_small_optim_setadam_epoch_50_lr_0.0001_eps_1.0E-08
2024-08-09 18:34:39,130 - __main__ - INFO - ==> Preparing data..
2024-08-09 18:34:39,146 - __main__ - INFO - ==> Building model..
2024-08-09 18:34:39,162 - __main__ - INFO - Model name: vit_small
2024-08-09 18:34:39,162 - __main__ - INFO - Total epochs: 50
2024-08-09 18:34:39,162 - __main__ - INFO - Using CUDA and data parallel
2024-08-09 18:35:14,460 - __main__ - INFO - epoch: 0 train_loss: 0.4673367928 train_acc: 84.3667 val_loss:  0.1699615188 val_acc: 94.7200 memory_usage: 1258.09 MiB
2024-08-09 18:35:49,225 - __main__ - INFO - epoch: 1 train_loss: 0.1723996525 train_acc: 94.5817 val_loss:  0.1388923382 val_acc: 95.6400 memory_usage: 1258.09 MiB
2024-08-09 18:36:23,869 - __main__ - INFO - epoch: 2 train_loss: 0.1267339419 train_acc: 96.0317 val_loss:  0.1035845816 val_acc: 96.5800 memory_usage: 1258.09 MiB
2024-08-09 18:36:58,637 - __main__ - INFO - epoch: 3 train_loss: 0.1029824460 train_acc: 96.8050 val_loss:  0.0953824587 val_acc: 97.0000 memory_usage: 1258.09 MiB
2024-08-09 18:37:33,658 - __main__ - INFO - epoch: 4 train_loss: 0.0871293744 train_acc: 97.2600 val_loss:  0.0927716076 val_acc: 97.0600 memory_usage: 1258.09 MiB
2024-08-09 18:38:08,777 - __main__ - INFO - epoch: 5 train_loss: 0.0767139863 train_acc: 97.6067 val_loss:  0.0848283550 val_acc: 97.4200 memory_usage: 1258.09 MiB
2024-08-09 18:38:43,733 - __main__ - INFO - epoch: 6 train_loss: 0.0660631478 train_acc: 97.9067 val_loss:  0.0952836393 val_acc: 97.3000 memory_usage: 1258.09 MiB
2024-08-09 18:39:18,861 - __main__ - INFO - epoch: 7 train_loss: 0.0615568355 train_acc: 98.0350 val_loss:  0.0910067965 val_acc: 97.2300 memory_usage: 1258.09 MiB
2024-08-09 18:39:54,056 - __main__ - INFO - epoch: 8 train_loss: 0.0511575960 train_acc: 98.3517 val_loss:  0.0735548208 val_acc: 97.8200 memory_usage: 1258.09 MiB
2024-08-09 18:40:28,919 - __main__ - INFO - epoch: 9 train_loss: 0.0475598615 train_acc: 98.4233 val_loss:  0.0852438341 val_acc: 97.6000 memory_usage: 1258.09 MiB
2024-08-09 18:41:04,065 - __main__ - INFO - epoch: 10 train_loss: 0.0430280924 train_acc: 98.5583 val_loss:  0.0817989489 val_acc: 97.7400 memory_usage: 1258.09 MiB
2024-08-09 18:41:39,260 - __main__ - INFO - epoch: 11 train_loss: 0.0384762806 train_acc: 98.7833 val_loss:  0.0685949872 val_acc: 97.8800 memory_usage: 1258.09 MiB
2024-08-09 18:42:14,041 - __main__ - INFO - epoch: 12 train_loss: 0.0362584253 train_acc: 98.7800 val_loss:  0.0824840018 val_acc: 97.7300 memory_usage: 1258.09 MiB
2024-08-09 18:42:48,909 - __main__ - INFO - epoch: 13 train_loss: 0.0316303628 train_acc: 98.9450 val_loss:  0.0682715805 val_acc: 97.9900 memory_usage: 1258.09 MiB
2024-08-09 18:43:23,882 - __main__ - INFO - epoch: 14 train_loss: 0.0304687775 train_acc: 98.9750 val_loss:  0.0927620181 val_acc: 97.4700 memory_usage: 1258.09 MiB
2024-08-09 18:43:58,990 - __main__ - INFO - epoch: 15 train_loss: 0.0258257214 train_acc: 99.1583 val_loss:  0.0773978403 val_acc: 97.9000 memory_usage: 1258.09 MiB
2024-08-09 18:44:33,956 - __main__ - INFO - epoch: 16 train_loss: 0.0250680081 train_acc: 99.1917 val_loss:  0.0807944525 val_acc: 97.7700 memory_usage: 1258.09 MiB
2024-08-09 18:45:09,040 - __main__ - INFO - epoch: 17 train_loss: 0.0199396404 train_acc: 99.3533 val_loss:  0.0736047820 val_acc: 97.9500 memory_usage: 1258.09 MiB
2024-08-09 18:45:44,293 - __main__ - INFO - epoch: 18 train_loss: 0.0189315387 train_acc: 99.3983 val_loss:  0.0788381509 val_acc: 97.9700 memory_usage: 1258.09 MiB
2024-08-09 18:46:19,285 - __main__ - INFO - epoch: 19 train_loss: 0.0207406982 train_acc: 99.3150 val_loss:  0.0807769500 val_acc: 97.8200 memory_usage: 1258.09 MiB
2024-08-09 18:46:54,290 - __main__ - INFO - epoch: 20 train_loss: 0.0160684861 train_acc: 99.4717 val_loss:  0.0850693404 val_acc: 97.9200 memory_usage: 1258.09 MiB
2024-08-09 18:47:29,481 - __main__ - INFO - epoch: 21 train_loss: 0.0139030966 train_acc: 99.5300 val_loss:  0.0835153429 val_acc: 97.7600 memory_usage: 1258.09 MiB
2024-08-09 18:48:04,342 - __main__ - INFO - epoch: 22 train_loss: 0.0120512667 train_acc: 99.6050 val_loss:  0.0688576341 val_acc: 98.1700 memory_usage: 1258.09 MiB
2024-08-09 18:48:39,133 - __main__ - INFO - epoch: 23 train_loss: 0.0107533194 train_acc: 99.6417 val_loss:  0.0816837581 val_acc: 98.0100 memory_usage: 1258.09 MiB
2024-08-09 18:49:14,065 - __main__ - INFO - epoch: 24 train_loss: 0.0111599816 train_acc: 99.6367 val_loss:  0.0765949977 val_acc: 98.1000 memory_usage: 1258.09 MiB
2024-08-09 18:49:49,158 - __main__ - INFO - epoch: 25 train_loss: 0.0096777239 train_acc: 99.7000 val_loss:  0.0702687060 val_acc: 98.1400 memory_usage: 1258.09 MiB
2024-08-09 18:50:24,108 - __main__ - INFO - epoch: 26 train_loss: 0.0105420510 train_acc: 99.6567 val_loss:  0.0786870471 val_acc: 98.0800 memory_usage: 1258.09 MiB
2024-08-09 18:50:59,254 - __main__ - INFO - epoch: 27 train_loss: 0.0083177106 train_acc: 99.7250 val_loss:  0.0691565489 val_acc: 98.3000 memory_usage: 1258.09 MiB
2024-08-09 18:51:34,631 - __main__ - INFO - epoch: 28 train_loss: 0.0079846511 train_acc: 99.7467 val_loss:  0.0776216903 val_acc: 98.1700 memory_usage: 1258.09 MiB
2024-08-09 18:52:09,924 - __main__ - INFO - epoch: 29 train_loss: 0.0048185956 train_acc: 99.8517 val_loss:  0.0767683778 val_acc: 98.2300 memory_usage: 1258.09 MiB
2024-08-09 18:52:44,942 - __main__ - INFO - epoch: 30 train_loss: 0.0038303433 train_acc: 99.8750 val_loss:  0.0786000947 val_acc: 98.3400 memory_usage: 1258.09 MiB
2024-08-09 18:53:20,173 - __main__ - INFO - epoch: 31 train_loss: 0.0040343157 train_acc: 99.8767 val_loss:  0.0753846380 val_acc: 98.3100 memory_usage: 1258.09 MiB
2024-08-09 18:53:55,039 - __main__ - INFO - epoch: 32 train_loss: 0.0045325321 train_acc: 99.8667 val_loss:  0.0764599385 val_acc: 98.1800 memory_usage: 1258.09 MiB
2024-08-09 18:54:29,856 - __main__ - INFO - epoch: 33 train_loss: 0.0041321202 train_acc: 99.8700 val_loss:  0.0765702039 val_acc: 98.2100 memory_usage: 1258.09 MiB
2024-08-09 18:55:04,630 - __main__ - INFO - epoch: 34 train_loss: 0.0027824567 train_acc: 99.9217 val_loss:  0.0747316189 val_acc: 98.3200 memory_usage: 1258.09 MiB
2024-08-09 18:55:39,820 - __main__ - INFO - epoch: 35 train_loss: 0.0023056531 train_acc: 99.9333 val_loss:  0.0745702261 val_acc: 98.3400 memory_usage: 1258.09 MiB
2024-08-09 18:56:14,941 - __main__ - INFO - epoch: 36 train_loss: 0.0016640237 train_acc: 99.9533 val_loss:  0.0702705642 val_acc: 98.4000 memory_usage: 1258.09 MiB
2024-08-09 18:56:50,070 - __main__ - INFO - epoch: 37 train_loss: 0.0015141106 train_acc: 99.9567 val_loss:  0.0697116708 val_acc: 98.4500 memory_usage: 1258.09 MiB
2024-08-09 18:57:25,464 - __main__ - INFO - epoch: 38 train_loss: 0.0012200475 train_acc: 99.9783 val_loss:  0.0711556496 val_acc: 98.4000 memory_usage: 1258.09 MiB
2024-08-09 18:58:00,638 - __main__ - INFO - epoch: 39 train_loss: 0.0009029678 train_acc: 99.9833 val_loss:  0.0780275761 val_acc: 98.2900 memory_usage: 1258.09 MiB
2024-08-09 18:58:35,549 - __main__ - INFO - epoch: 40 train_loss: 0.0007323480 train_acc: 99.9933 val_loss:  0.0738456877 val_acc: 98.3500 memory_usage: 1258.09 MiB
2024-08-09 18:59:10,681 - __main__ - INFO - epoch: 41 train_loss: 0.0006983211 train_acc: 99.9883 val_loss:  0.0754157372 val_acc: 98.5100 memory_usage: 1258.09 MiB
2024-08-09 18:59:45,656 - __main__ - INFO - epoch: 42 train_loss: 0.0007502761 train_acc: 99.9833 val_loss:  0.0775799613 val_acc: 98.4200 memory_usage: 1258.09 MiB
2024-08-09 19:00:20,392 - __main__ - INFO - epoch: 43 train_loss: 0.0005570735 train_acc: 99.9950 val_loss:  0.0763678335 val_acc: 98.4400 memory_usage: 1258.09 MiB
2024-08-09 19:00:55,301 - __main__ - INFO - epoch: 44 train_loss: 0.0005225790 train_acc: 99.9917 val_loss:  0.0746444872 val_acc: 98.5700 memory_usage: 1258.09 MiB
2024-08-09 19:01:30,365 - __main__ - INFO - epoch: 45 train_loss: 0.0004438232 train_acc: 99.9967 val_loss:  0.0755444257 val_acc: 98.5500 memory_usage: 1258.09 MiB
2024-08-09 19:02:05,567 - __main__ - INFO - epoch: 46 train_loss: 0.0004672507 train_acc: 99.9917 val_loss:  0.0720144024 val_acc: 98.5700 memory_usage: 1258.09 MiB
2024-08-09 19:02:40,562 - __main__ - INFO - epoch: 47 train_loss: 0.0003665419 train_acc: 99.9967 val_loss:  0.0727256650 val_acc: 98.5600 memory_usage: 1258.09 MiB
2024-08-09 19:03:15,840 - __main__ - INFO - epoch: 48 train_loss: 0.0004582351 train_acc: 99.9933 val_loss:  0.0737280996 val_acc: 98.5700 memory_usage: 1258.09 MiB
2024-08-09 19:03:51,602 - __main__ - INFO - epoch: 49 train_loss: 0.0003970593 train_acc: 99.9933 val_loss:  0.0738872685 val_acc: 98.5500 memory_usage: 1258.09 MiB
2024-08-09 19:03:51,602 - __main__ - INFO - Best accuracy: 98.5700
2024-08-09 19:03:51,602 - __main__ - INFO - Max memory usage: 1258.09 MB
2024-08-09 19:03:51,602 - __main__ - INFO - Total memory usage: 62904.64 MiB
